getgenv().TriggerBotEnabled = true
getgenv().TriggerKey = Enum.KeyCode.C
getgenv().FOVRadius = 30

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local StarterGui = game:GetService("StarterGui")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local Camera = workspace.CurrentCamera

local validParts = {
    ["Head"] = true,
    ["Torso"] = true,
    ["UpperTorso"] = true,
    ["LowerTorso"] = true,
    ["HumanoidRootPart"] = true
}

local FOV = Drawing.new("Circle")
FOV.Visible = true
FOV.Radius = getgenv().FOVRadius
FOV.Color = Color3.fromRGB(255, 0, 0)
FOV.Thickness = 1.5
FOV.Filled = false
FOV.Transparency = 0.6

StarterGui:SetCore("SendNotification", {
    Title = "Trigger Bot",
    Text = "Loaded successfully!",
    Duration = 3
})

-- Update the position of the FOV circle to follow the mouse correctly
RunService.RenderStepped:Connect(function()
    FOV.Position = Vector2.new(Mouse.X, Mouse.Y)
    FOV.Visible = getgenv().TriggerBotEnabled
end)

-- Toggle TriggerBot on/off with the C key
UIS.InputBegan:Connect(function(input, gpe)
    if not gpe and input.KeyCode == getgenv().TriggerKey then
        getgenv().TriggerBotEnabled = not getgenv().TriggerBotEnabled
        StarterGui:SetCore("SendNotification", {
            Title = "Trigger Bot",
            Text = getgenv().TriggerBotEnabled and "Enabled" or "Disabled",
            Duration = 2
        })
    end
end)

-- Trigger bot logic: Fire when an enemy is within FOV and mouse is aimed at a valid part
RunService.RenderStepped:Connect(function()
    if getgenv().TriggerBotEnabled then
        local targetPart = Mouse.Target
        if targetPart then
            local model = targetPart:FindFirstAncestorOfClass("Model")
            local player = Players:GetPlayerFromCharacter(model)

            -- Check if target is a valid player and within FOV
            if player and player ~= LocalPlayer and validParts[targetPart.Name] then
                local screenPos, onScreen = Camera:WorldToViewportPoint(targetPart.Position)
                if onScreen and (Vector2.new(Mouse.X, Mouse.Y) - Vector2.new(screenPos.X, screenPos.Y)).Magnitude <= getgenv().FOVRadius then
                    -- Perform trigger bot action by simulating mouse click
                    task.delay(0.001, function()
                        mouse1press()
                        task.wait()
                        mouse1release()
                    end)
                end
            end
        end
    end
end)
